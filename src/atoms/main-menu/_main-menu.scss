@charset "UTF-8";
@use '../../configurations/mixins' as m;
@use '../../configurations/bem' as m2;
@use '../../configurations/variables' as v;
@use '../../configurations/colors/colors' as c;
@use '../../vendor/grid/breakpoints' as bp;

@include m.atom(main-menu) {

	@include m2.e(list) {
		$root: &;

		display: flex;
		justify-content: flex-end;
		width: 100%;
		margin: 0;
		padding: 0;
		list-style: none;

		li {
			display: flex;
			align-items: center;
			position: relative;

			&:last-child {
				#{$root}#{m2.$element-separator}link {
					padding-right: 0;
				}
			}
		}

		@include m2.e(button) {
			padding: rhythm(2) 0 rhythm(2) rhythm(1);

			@include m.atom(button) {
				padding: rhythm(0.4) rhythm(1.5);
				font-family: v.$font-family-medium;
				font-size: v.$size-small;

				@include m2.e(text) {
					overflow: hidden;
					text-overflow: ellipsis;
					white-space: nowrap;
				}

				@include m2.m(icon-left) {
					padding-left: rhythm(5);
				}

				@include m2.m(icon-right) {
					padding-right: rhythm(5);
				}
			}

			@include bp.bp-up(sm) {
				@include m.atom(button) {
					padding-top: rhythm(0.6);
					padding-bottom: rhythm(0.6);
					font-size: v.$size-base;
				}
			}
		}

		@include m2.e(link) {
			@extend %normalize-links;

			display: flex;
			align-items: center;
			padding: rhythm(2) rhythm(1);
			border: 0;
			background-color: transparent;
			color: var(--cyberspace-color);
			font-family: v.$font-family-medium;
			font-size: to_rem(v.$size-small);
			text-decoration: none;
			-webkit-appearance: none;
			line-height: 1;

			&:focus,
			&:hover {
				text-decoration: underline;
			}

			&.is-current {
				color: c.$color-ruby;
				font-family: v.$font-family-medium;
			}

			&[aria-expanded='true'] {

				@include m2.b(icon-hamburger) {
					transform: rotate(-90deg);
					background-color: transparent;

					&::before {
						top: 0;
						transform: rotate(45deg);
					}

					&::after {
						bottom: 0;
						transform: rotate(-45deg);
					}
				}

				@include m2.b(icon-arrow-down) {
					&::before {
						left: 0;
						width: 100%;
						transform: rotate(-45deg);
					}

					&::after {
						right: 0;
						width: 100%;
						transform: rotate(45deg);
					}
				}
			}

			@include m2.b(icon-hamburger) {
				display: flex;
				position: relative;
				z-index: -1;
				flex-direction: column;
				width: v.$icon-size-medium;
				height: 2px;
				margin-left: rhythm(1);
				transform-origin: 50% 50%;
				transition: all 0.3s ease-out, background-color 0.15s ease-out;
				border: 0;
				border-radius: 0;
				background-color: currentColor;
				color: var(--cyberspace-color);

				&::before,
				&::after {
					content: '';
					display: block;
					position: absolute;
					width: 100%;
					height: 2px;
					transition: transform 0.3s ease-out, top 0.3s ease-out, bottom 0.3s ease-out;
					background-color: currentColor;
				}

				&::before {
					top: -#{to_rem(6px)};
				}

				&::after {
					bottom: -#{to_rem(6px)};
				}
			}

			@include m2.b(icon-arrow-down) {
				display: flex;
				position: relative;
				z-index: -1;
				flex-direction: column;
				width: v.$icon-size-medium;
				height: v.$icon-size-medium;
				margin-left: rhythm(1);
				margin-top: -#{to_rem(3px)};
				transform-origin: 50% 50%;
				transition: all 0.3s ease-out;
				border: 0;
				border-radius: 0;
				color: var(--cyberspace-color);

				&::before,
				&::after {
					content: '';
					display: block;
					position: absolute;
					top: 50%;
					width: 75%;
					height: 2px;
					transition: all 0.3s ease-out;
					background-color: currentColor;
				}

				&::before {
					left: -#{to_rem(2px)};
					transform: rotate(45deg);
				}

				&::after {
					right: -#{to_rem(2px)};
					transform: rotate(-45deg);
				}
			}

			@include bp.bp-up(sm) {
				font-size: v.$size-base;
			}
		}

		@include m2.e(text) {
			margin-top: -#{to_rem(3px)}; // Adjust for the font's bad placement in viewbox
			pointer-events: none;
		}
	}

	@include m2.e(subnav) {
		position: absolute;
		left: 0;
		top: calc(100% - #{rhythm(1)});
		margin: 0;
		padding: 0;
		background-color: c.$color-snow;
		border: 1px solid c.$color-ash;

		@include m.card-shadow(c.$color-cyberspace, 0.2);

		&::after,
		&:before {
			bottom: 100%;
			left: rhythm(4);
			border: solid transparent;
			content: '';
			height: 0;
			width: 0;
			position: absolute;
			pointer-events: none;
		}

		&::after {
			border-color: rgba(255, 255, 255, 0);
			border-bottom-color: c.$color-snow;
			border-width: 15px;
			margin-left: -15px;
		}
		&::before {
			border-color: rgba(238, 238, 238, 0);
			border-bottom-color: c.$color-ash;
			border-width: 16px;
			margin-left: -16px;
		}

		&[aria-hidden='true'],
		&:not([aria-hidden]) {
			display: none;
		}

		@include m2.e(item) {
			width: 100%;

			& + & {
				border-top: 1px solid c.$color-ash;
			}

			a {
				color: c.$color-cyberspace;
				display: block;
				width: 100%;
				padding: rhythm(0.5) rhythm(2);
				text-decoration: none;
				white-space: nowrap;

				&:hover {
					text-decoration: underline;
				}
			}
		}
	}
}

.no-js {
	@include m.atom(main-menu) {
		@include m2.e(subnav) {
			display: block;
		}
	}
}
